<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="css/style.css" type="text/css" rel="stylesheet" />
    <title></title>
  </head>
  <body>
    <div class="container">
      <h1>ToDo</h1>
      <form>
        <label><h2>Add a ToDo</h2>
          <input id="newTodo" />
        </label>
        <button id="addTodoBtn">Add</button>
      </form>
      <section>
        <h2>ToDos</h2>
        <div id="todolist"></div>
      </section>
    </div>

    <div id="TodoTemplate">
      <div><input type="checkbox" /><label></label></div>
    </div>

    <script>

      removeTodo = (evt) => {
        let todoIndex = evt.target.getAttribute('data-todo-index');
        todos.splice(todoIndex, 1);
        drawTodos();
      }

      drawTodos = () => {
        let todolist = document.getElementById('todolist');
        todolist.innerHTML = "";
        let todoTemplate = document.querySelector('#TodoTemplate div');
        for(let i = 0; i < todos.length; i++){
          let newTodo = todoTemplate.cloneNode(true);
          newTodo.setAttribute('data-todo-index', i);
          let label = newTodo.querySelector('label');
          label.textContent = todos[i];

          let checkbox = newTodo.querySelector('input');
          checkbox.addEventListener('click', removeTodo);
          checkbox.setAttribute('data-todo-index', i);
          todolist.appendChild(newTodo);
        }
      }

      addTodo = evt => {
        evt.preventDefault();
        let newTodo = document.getElementById("newTodo").value;
        if (newTodo) {
          todos.push(newTodo);
        }
        drawTodos();
      };

      let todos = [];
      document.getElementById("addTodoBtn").addEventListener("click", addTodo);
    </script>
  </body>
</html>
